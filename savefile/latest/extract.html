<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extract :: TTS Tools</title>
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">TTS Tools</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="savefile" data-version="2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">savefile</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="extract.html">Extract</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="embed.html">Embed</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cli.html">Command Line Interface</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">savefile</span>
    <span class="version">2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">savefile</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../editor/latest/index.html">TTS Editor</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../editor/latest/index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">savefile</a></li>
    <li><a href="extract.html">Extract</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/Sebaestschjin/tts-tools/edit/main/packages/savefile/docs/modules/ROOT/pages/extract.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Extract</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Extracting a save file splits it into a nested directory structure.
Each folder contains the information for one object (or Global).
It contains different files per object, depending on what attributes it has (listed in the sections below).
The files all have the same name, they are discriminated by the directory they are part of.</p>
</div>
<div class="paragraph">
<p>The data from Global will be on the top level of the output directory.
From there the directory <code>Contents</code> contains the globally available objects.
Object directories are named by using their nickname (the applied name that is also visible in the TTS tooltip), followed by a dot and their GUID.
If the object doesn&#8217;t have nickname, their internal name is used instead.
If the object is a container (a bag or deck), it&#8217;s content is again nested inside the <code>Contents</code> directory.
The same applies for states</p>
</div>
<div class="paragraph">
<p>This process will create a directory structure like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;output-path&gt;
├─ Data.json
├─ Contents.json
├─ Script.ttslua
├─ State.txt
├─ UI.xml
├─ Contents -- since this is Global, this contains all global objects
│ ├─ Bag.abc123
| | ├─ Contents.json
| | ├─ Data.json
| │ ├─ Script.ttslua
| | ├─ State.txt
| | ├─ States.json
| | ├─ UI.xml
| | ├─ Contents -- this object is a container, so this contains the contained objects
| | | ├─ CoolFigure.123456
| | ├─ States -- when the object is stated, the states are kept here
| | | ├─ 2-OtherBag.123456
| | | ├─ 3-MoreOtherBag.111111
│ ├─ HandTrigger.123abc</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_options"><a class="anchor" href="#_options"></a>Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Api offers several options</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>output</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The path where the save file will be extracted to.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>normalize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean/number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If set, floating point values will be rounded to the 4th decimal point.
When a number is given instead of a boolean, the values will be rounded to that decimal point instead.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If set, the script states of objects will also be extracted.
Otherwise, they will be ignored, effectively clearing the state of all objects.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>contentsPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the directory for a container object or the global table where each contained object will be written to.
Defaults to no name, meaning objects are extracted directly into their container directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>statesPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the directory for an object with multiple states where each state will be written to.
Defaults to no name, meaning states are extracted directly into their object&#8217;s directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>childrenPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the directory for an object with attachments where each attachment will be written to.
Defaults to no name, meaning attachments are extracted directly into their object&#8217;s directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keyOrder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A list of names for fields in an object&#8217;s data.
When set the keys in each <code>Data.json</code> file will be sorted by this order.
Each field not listed will be sorted alphabetically after each listed field was sorted accordinly.</p>
</div>
<div class="paragraph">
<p>E.g. an object data like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "GUID": "12356",
  "Name": "Custom_Token",
  "CustomImage": {
    "CustomToken": {
      "StandUp": false,
      "Stackable": false,
      "Thickness": 0.1,
      "MergeDistancePixels": 15.0001
    },
    "ImageSecondaryURL": "..",
    "ImageURL": "..."
  },
  "Nickname": "Test"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>with a <code>keyOrder</code> option <code>["GUID", "Name", "Nickname", "ImageURL", "ImageSecondaryURL"]</code>, would create a <code>Data.json</code> file like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "GUID": "12356",
  "Name": "Custom_Token",
  "Nickname": "Test",
  "CustomImage": {
    "ImageURL": "...",
    "ImageSecondaryURL": "..",
    "CustomToken": {
      "MergeDistancePixels": 15.0001,
      "Stackable": false,
      "StandUp": false,
      "Thickness": 0.1
    }
  }
}</code></pre>
</div>
</div>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_files"><a class="anchor" href="#_files"></a>Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following files are created while extracting (when applicable).</p>
</div>
<div class="sect2">
<h3 id="_script_ttslua"><a class="anchor" href="#_script_ttslua"></a><code>Script.ttslua</code></h3>
<div class="paragraph">
<p>This file contains the Lua script attached to the object (or Global).
If the script contains <code>require()</code> calls, it will be unbundled, so that only the root module will be written to the file.
E.g. this is the same behavior seen in the TTS editor plugins, so that only the relevant code is written to the file.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>This tool does not (and does not intend to) support the use of the <code>#include</code> directive that is available in the Atom TTS plugin.
Please use <code>require()</code> instead.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_ui_xml"><a class="anchor" href="#_ui_xml"></a><code>UI.xml</code></h3>
<div class="paragraph">
<p>This file contains the XML UI attached to the object (or Global).
Like the script it will be unbundled, so it contains the <code>&lt;Include src="" /&gt;</code> directives from the original code similar to the behavior from the Atom TTS plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="_state_txt"><a class="anchor" href="#_state_txt"></a><code>State.txt</code></h3>
<div class="paragraph">
<p>This file contains the script state of the object (or Global).</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_json"><a class="anchor" href="#_data_json"></a><code>Data.json</code></h3>
<div class="paragraph">
<p>This file contains the data from the original save file for this object (or Global).
Fields that where extracted (e.g. the Lua script or XML UI), will be empty and not included in the file.
Adding contents to those fields will be ignored as their contents is solely driven by the available files for this object.</p>
</div>
</div>
<div class="sect2">
<h3 id="_contents_json"><a class="anchor" href="#_contents_json"></a><code>Contents.json</code></h3>
<div class="paragraph">
<p>This file keeps the order of contained elements within a container or the globally available objects in case of Global.
It contains a simple array with the relative path to the object within the <code>Contents</code> directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_states_json"><a class="anchor" href="#_states_json"></a><code>States.json</code></h3>
<div class="paragraph">
<p>This file keeps the order of states of an object.
It contains a simple array with the relative path to the object within the <code>States</code> directory.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="200" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
